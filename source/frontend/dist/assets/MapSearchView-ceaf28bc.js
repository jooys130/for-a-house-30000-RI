import{v as ae,g as v,_ as E,s as D,m as U,i as T,o as d,c as g,q as H,f as O,r as f,h as V,w as l,e as n,a as r,x as se,t as $,F as L,j as B,d as S,y as oe,p as G,b as P,z as ne,A as Y,B as F}from"./index-03511842.js";import ce from"./VChart-0644a672.js";const J=ae("mapStore",()=>({selectApt:v({})}));const ue={__name:"KakaoMap",props:{results:Array},setup(a){const m=J(),{selectApt:_}=D(m);var p;const h=v([]),k=v([]),u=a;U(_,()=>{console.log(_.value);var t=new kakao.maps.LatLng(_.value.lat,_.value.lng),s=p.getLevel();p.setLevel(s-2),p.panTo(t)},{deep:!0}),T(()=>{if(window.kakao&&window.kakao.maps)C();else{const t=document.createElement("script");t.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=b97fad2281701d2271d2ca67135e92e5&libraries=services,clusterer",t.onload=()=>kakao.maps.load(()=>C()),document.head.appendChild(t)}}),U(()=>u.results.value,()=>{h.value=[],u.results.forEach(t=>{let s={};s.latlng=new kakao.maps.LatLng(t.lat,t.lng),s.title=t.statNm,h.value.push(s)}),x()},{deep:!0});const b=v(null),C=()=>{const t=document.getElementById("map"),s={center:new kakao.maps.LatLng(33.450701,126.570667),level:3};p=new kakao.maps.Map(t,s)},x=()=>{y();const t=new kakao.maps.Size(24,35),s="/map/markStar2.png",c=new kakao.maps.MarkerImage(s,t);k.value=[],h.value.forEach(o=>{console.log(c);const e=new kakao.maps.Marker({map:p,position:o.latlng,title:o.title,clickable:!0,image:c});k.value.push(e)});const I=h.value.reduce((o,e)=>o.extend(e.latlng),new kakao.maps.LatLngBounds);p.setBounds(I)},y=()=>{k.value.length>0&&k.value.forEach(t=>t.setMap(null))};return(t,s)=>(d(),g("div",{id:"map",ref_key:"map1",ref:b},null,512))}},re=E(ue,[["__scopeId","data-v-1913e5c9"]]),Q=H();function de(a,m,_){console.log("got param "+a.sidoName+a.gugunName+a.dongName),Q.get("/apt/keySearch",{params:a}).then(m).catch(_)}function ie(a,m,_){Q.get(`/apt/dealSearch/${a}`).then(m).catch(_)}const j=a=>(G("data-v-0f6526c4"),a=a(),P(),a),ve={class:"d-flex justify-space-between"},_e=["src"],pe={class:"d-flex flex-wrap align-center"},me={class:"ma-3",style:{font:"50px gBold"}},fe=["src"],ge=j(()=>r("div",{class:"ml-4",style:{font:"30px gBold"}},"거래량 분석",-1)),he=j(()=>r("div",{class:"ml-4",style:{font:"30px gBold"}},"매매내역",-1)),ke=j(()=>r("div",{style:{width:"10%"}},null,-1)),ye={class:"d-flex align-center mx-6"},be=j(()=>r("br",null,null,-1)),xe={__name:"AptListItem",props:{result:Object},setup(a){const m=H(),_=O(),{userInfo:p}=D(_),h=v(!1),k=a,u=v([]),b=v([]),C=v([]),x=v([]),y=v([2015,2016,2017,2018,2019,2020,2021,2022]),t=v({title:"년도별 거래량",categories:y.value,datas:[]}),s=async o=>{console.log("아파트 매매정보 찾자!"),console.log(o),await ie(o,e=>{if(e.status===ne.OK){u.value=e.data.aptDealList,b.value=e.data.aptDealList,C.value=e.data.validYear,x.value=[];for(let w=0;w<y.value.length;w++){console.log(u.value[0].dealYear,y.value[0]);let A=u.value.filter(R=>R.dealYear===y.value[w]).length;t.value.datas.push(A)}}},e=>{console.error(e)})},c=o=>{console.log(o),o!==void 0?b.value=u.value.filter(e=>e.dealYear===o):b.value=u.value},I=(o,e)=>{if(console.log(o),console.log(e.aptCode),p.value==null){h.value=!0;return}else o==0?(console.log("좋아요로 바뀌어야 함"),m.post("/apt/fav",{userId:p.value.userId,aptCode:e.aptCode}).then(()=>{console.log("favReg 등록 : 성공"),e.likeStatus=1}).catch(()=>{console.log("favReg 등록 : 실패")})):(console.log("안좋아요 ㅠㅠ"),m.post(`/apt/fav/${p.value.userId}/${e.aptCode}`).then(()=>{console.log("favReg 삭제 : 성공"),e.likeStatus=0}).catch(()=>{console.log("favReg 삭제 : 실패")}))};return(o,e)=>{const w=f("v-btn"),A=f("v-card-title"),R=f("v-btn-toggle"),z=f("v-chip"),M=f("v-col"),K=f("v-row"),W=f("v-container"),X=f("v-virtual-scroll"),Z=f("v-card-text"),q=f("v-card"),ee=f("v-dialog"),te=f("v-snackbar");return d(),V(q,{class:oe(["ma-lg-3",{liked:a.result.likeStatus==1}]),width:"250",height:"140",style:{"background-color":"#E3F2FD"},title:k.result.apartmentName,text:`준공년도 : ${k.result.buildYear}`,elevation:17},{default:l(()=>[n(ee,{width:"800"},{activator:l(({props:i})=>[r("div",ve,[n(w,se({class:{likedBtn:a.result.likeStatus==1}},i,{text:"Detail",style:{"background-color":"#BBDEFB","margin-left":"6%"},onClick:e[0]||(e[0]=le=>s(a.result.aptCode))}),null,16,["class"]),r("img",{class:"likeImg mr-3",src:`src/assets/img/heart/like_${a.result.likeStatus}.png`,style:{width:"40px",height:"40px"},alt:""},null,8,_e)])]),default:l(({})=>[n(q,null,{default:l(()=>[r("div",pe,[n(A,{class:"h_container"},{default:l(()=>[r("div",me,$(a.result.apartmentName),1),r("img",{class:"likeImg",src:`src/assets/img/heart/like_${a.result.likeStatus}.png`,onClick:e[1]||(e[1]=i=>I(a.result.likeStatus,a.result)),style:{display:"block",width:"40px",height:"40px"},alt:""},null,8,fe)]),_:1})]),n(A,{class:"d-flex align-center"},{default:l(()=>[ge]),_:1}),n(ce,{chartMaterial:t.value},null,8,["chartMaterial"]),n(A,{class:"d-flex align-center"},{default:l(()=>[he,ke]),_:1}),r("div",ye,[n(R,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=i=>x.value=i),style:{font:"15px gMedium"}},{default:l(()=>[(d(!0),g(L,null,B(C.value,i=>(d(),V(w,{key:i.value,value:i,onClick:e[2]||(e[2]=le=>c(x.value))},{default:l(()=>[S($(i),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),n(Z,null,{default:l(()=>[n(X,{items:b.value,height:"400"},{default:l(({item:i})=>[n(W,{class:"my-2",style:{"background-color":"#E0F2F1"}},{default:l(()=>[n(K,{"no-gutters":"",class:"center-content"},{default:l(()=>[n(M,null,{default:l(()=>[n(z,{class:"ma-2 custom-chip",color:"#00695C",label:""},{default:l(()=>[S("🗓️ 매매년월")]),_:1})]),_:1}),n(M,{class:"custom-font"},{default:l(()=>[S($(i.dealYear)+"년 "+$(i.dealMonth)+"월 ",1)]),_:2},1024),n(M,null,{default:l(()=>[n(z,{class:"ma-2 custom-chip",color:"#00695C",label:""},{default:l(()=>[S("💵 가격(만원)")]),_:1})]),_:1}),n(M,{class:"custom-font"},{default:l(()=>[S($(i.dealAmount),1)]),_:2},1024)]),_:2},1024),n(K,{"no-gutters":"",class:"center-content"},{default:l(()=>[n(M,null,{default:l(()=>[n(z,{class:"ma-2 custom-chip",color:"#00695C",label:""},{default:l(()=>[S("🏢 평수")]),_:1})]),_:1}),n(M,{class:"custom-font"},{default:l(()=>[S($(i.area),1)]),_:2},1024),n(M,null,{default:l(()=>[n(z,{class:"ma-2 custom-chip",color:"#00695C",label:""},{default:l(()=>[S("👟 층")]),_:1})]),_:1}),n(M,{class:"custom-font"},{default:l(()=>[S($(i.floor),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["items"]),be]),_:1})]),_:1})]),_:1}),n(te,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=i=>h.value=i)},{actions:l(()=>[n(w,{color:"pink",variant:"text",onClick:e[4]||(e[4]=i=>h.value=!1)},{default:l(()=>[S(" Close ")]),_:1})]),default:l(()=>[S(" 로그인이 필요한 서비스입니다. ")]),_:1},8,["modelValue"])]),_:1},8,["class","title","text"])}}},we=E(xe,[["__scopeId","data-v-0f6526c4"]]);const Se={key:1},$e={__name:"MapSrchRes",props:{results:Array},setup(a){const m=a,_=J(),{selectApt:p}=D(_),h=k=>{p.value=k};return(k,u)=>{const b=f("v-virtual-scroll"),C=f("v-sheet");return d(),V(C,{class:"d-flex flex-column align-center mb-6 bg-surface-variant pa-lg-6",width:"20vw",height:"100vh",id:"container"},{default:l(()=>[m.results.length>0?(d(),V(b,{key:0,items:[0]},{default:l(()=>[(d(!0),g(L,null,B(m.results,x=>(d(),V(we,{key:x.value,result:x,onClick:y=>h(x)},null,8,["result","onClick"]))),128))]),_:1})):(d(),g("div",Se," 조회되는 매매 정보가 없습니다. "))]),_:1})}}},Ce=E($e,[["__scopeId","data-v-92104c91"]]);const N=a=>(G("data-v-1e00306e"),a=a(),P(),a),Me={id:"inner-form"},Ie=N(()=>r("option",{selected:""},"--시도선택--",-1)),Le=["value"],Ae=N(()=>r("option",{selected:""},"--구군선택--",-1)),Ve=["value"],Be=N(()=>r("option",{selected:""},"--동 선택--",-1)),Ne=["value"],ze={id:"map_search_container"},Ee={key:0,class:"note"},De=N(()=>r("p",null,"지역 정보를 입력해주세요",-1)),je=[De],Re={key:1,class:"note"},Ye=N(()=>r("p",null,"매매정보가 없습니다. ",-1)),Fe=[Ye],Ue={__name:"MapSearchView",setup(a){const m=v(),_=v(),p=v(),h=O(),{userInfo:k}=D(h),u=v([]),b=function(t,s){const c="https://grpc-proxy-server-mkvo6j4wsq-du.a.run.app/v1/regcodes";let I="regcode_pattern="+s+"&is_ignore_zero=true";t==0?fetch(`${c}?${I}`).then(o=>o.json()).then(o=>{m.value=o.regcodes}):t==1?fetch(`${c}?${I}`).then(o=>o.json()).then(o=>{o.regcodes.forEach(e=>{e.name.split(" ").length==2?e.name=e.name.split(" ")[1]:e.name=e.name.split(" ")[1]+" "+e.name.split(" ")[2]}),_.value=o.regcodes}):t==2&&fetch(`${c}?${I}`).then(o=>o.json()).then(o=>{let e=2;o.regcodes.forEach(w=>{w.name.split(" ").length!=3&&(e=3),w.name=w.name.split(" ")[e]}),p.value=o.regcodes})},C=function(t){b(1,t.code.substr(0,2)+"*00000")},x=function(t){b(2,t.code.substr(0,5)+"*")};T(()=>{b(0,"*00000000")});const y=v([]);return U(u.value,()=>{const t={sidoName:u.value[0]==null?null:u.value[0].name,gugunName:u.value[1]==null?null:u.value[1].name,dongName:u.value[2]==null?null:u.value[2].name,userId:k.value===null?null:k.value.userId};console.log(t),t.sidoName!=null&&t.gugunName!=null&&t.dongName!=null&&de(t,s=>{y.value=s.data,console.log("확인해보자!"),console.log(y.value)},s=>{console.log(s)})}),(t,s)=>(d(),g(L,null,[r("form",null,[r("div",Me,[Y(r("select",{"onUpdate:modelValue":s[0]||(s[0]=c=>u.value[0]=c),class:"b_round_bar size_mid",onChange:s[1]||(s[1]=c=>C(u.value[0]))},[Ie,(d(!0),g(L,null,B(m.value,c=>(d(),g("option",{key:c.value,value:c},$(c.name),9,Le))),128))],544),[[F,u.value[0],void 0,{lazy:!0}]]),Y(r("select",{"onUpdate:modelValue":s[2]||(s[2]=c=>u.value[1]=c),class:"b_round_bar size_mid",onChange:s[3]||(s[3]=c=>x(u.value[1]))},[Ae,(d(!0),g(L,null,B(_.value,c=>(d(),g("option",{key:c.value,value:c},$(c.name),9,Ve))),128))],544),[[F,u.value[1],void 0,{lazy:!0}]]),Y(r("select",{"onUpdate:modelValue":s[4]||(s[4]=c=>u.value[2]=c),class:"b_round_bar size_mid"},[Be,(d(!0),g(L,null,B(p.value,c=>(d(),g("option",{key:c.value,value:c},$(c.name),9,Ne))),128))],512),[[F,u.value[2],void 0,{lazy:!0}]])])]),r("div",ze,[u.value.length<3?(d(),g("div",Ee,je)):y.value.length===0&&u.value.length===3?(d(),g("div",Re,Fe)):(d(),g(L,{key:2},[n(re,{results:y.value},null,8,["results"]),n(Ce,{results:y.value},null,8,["results"])],64))])],64))}},Te=E(Ue,[["__scopeId","data-v-1e00306e"]]);export{Te as default};
